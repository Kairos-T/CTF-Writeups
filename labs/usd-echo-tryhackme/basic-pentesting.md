---
description: Web App Testing, Privilege Escalation
---

# Basic Pentesting

This is my first ever lab in THM! It was pretty interesting to apply the tools like nmap, LinPEAS, enum4linux, Hydra and more.&#x20;

Lab: [https://tryhackme.com/room/basicpentestingjt](https://tryhackme.com/room/basicpentestingjt)



### Tasks

1. **Deploy the Machine and connect to our network**\
   \
   Refer to the THM [https://tryhackme.com/access](https://tryhackme.com/access) webpage to set up the machine and VPN

***

2. **Find the services exposed by the machine**\
   **Question Hint:** use an nmap scan to look for the open ports\
   \
   This tests on the basics on network recon. I created a directory first, to store the output and used sublime text to read through the output better (rather than reading it off the CLI)

{% code overflow="wrap" %}
```sh
mkdir nmap
nmap -sC -sV -oN nmap/initial
subl nmap/initial
```
{% endcode %}

<details>

<summary>Break down of scan</summary>

\-sC runs a set of default scripts against open ports to tdetermine if there are known vulnerabilities or misconfigurations that we can use

\-sV probes all open ports it finds, determining if we are able to get the service version information. This allows us in identifying potential vulnerabilities associated with the version of that service

\-oN just specifies the output format and file for scan results (initial will be the file within the directory "nmap" here)

</details>

<figure><img src="../../.gitbook/assets/image (24).png" alt=""><figcaption></figcaption></figure>

From here, there are a few open ports: 22 running Ubuntu, 139 running Samba, 445 running Samba.&#x20;

Hence, these are the services exposed by the machine.

***

3. **What is the name of the hidden directory on the webserver(enter name without /)?**\
   **Question Hint:** use dirsearch/dirbuster to find the hidden directories

While I didn't use dirbuster/dirsearch/gobuster for this question, I found out that you can use nmap and enum4linux directly to retreive the hidden directory.



Firstly, I went to the webserver to take a look which showed this (ctrl+u to view source)

<figure><img src="../../.gitbook/assets/image (34).png" alt=""><figcaption></figcaption></figure>

Based on this, there should be a dev note section somewhere, so we have to use a domain enumeration tool.&#x20;

<pre class="language-sh" data-overflow="wrap"><code class="lang-sh"><strong>sudo nmap -p80 --script http-enum 10.10.38.122
</strong>enum4linux -a 10.10.38.122 | tee enum4linux.log
subl enum4linux.log
</code></pre>

<details>

<summary>Break down of commands</summary>

sudo nmap -p80 http-enum 10.10.38.122

* This command uses nmap with elevated privileges (sudo) to scan the target IP.
* \--script http-enum instructs nmap to use the http-enum script which is for information gathering for HTTP services
* \-p80 specifies port 80, which is for HTTP traffic.

&#x20;enum4linux -a 10.10.38.122 | tee enum4linux.log

* This utilises the enum4linux tool to perform enuneration on the target.
* \-a specifies "all", for a comprehensive scan to gather as much information as possible.
* I used | tee enum4linux.log to redirect the output to console and saving it to the log file as it got pretty long and messy.

&#x20;subl enum4linux.log

* used sublime text to open the log file in it.

</details>

<figure><img src="../../.gitbook/assets/image (30).png" alt=""><figcaption></figcaption></figure>

And that was the output! /development/ was the directory we were looking for. Entering the flag development gave us the correct answer. :)



Opening the site, I am faced with&#x20;

<figure><img src="../../.gitbook/assets/image (33).png" alt=""><figcaption></figcaption></figure>

in dev.txt:

<pre data-overflow="wrap"><code><strong>2018-04-23: I've been messing with that struts stuff, and it's pretty cool! I think it might be neat
</strong>to host that on this server too. Haven't made any real web apps yet, but I have tried that example
you get to show off how it works (and it's the REST version of the example!). Oh, and right now I'm
using version 2.5.12, because other versions were giving me trouble. -K

2018-04-22: SMB has been configured. -K

2018-04-21: I got Apache set up. Will put in our content later. -J
</code></pre>



in j.txt:&#x20;

{% code overflow="wrap" %}
```
For J:

I've been auditing the contents of /etc/shadow to make sure we don't have any weak credentials,
and I was able to crack your hash really easily. You know our password policy, so please follow
it? Change that password ASAP.

-K
```
{% endcode %}

***

4. **User brute-forcing to find the username & password**

Going to the enum4linux script, I am able to get the usernames available, which...

<figure><img src="../../.gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>

... does answer question 5 and 9

Moving on to finding the password, I used hydra with the rockyou.txt file to bruteforce it.

{% code overflow="wrap" %}
```sh
hydra -l jan -P '/usr/share/wordlists/rockyou.txt' ssh://10.10.38.122

```
{% endcode %}

<details>

<summary>Command break down</summary>

hydra -l jan -P '/usr/share/wordlists/rockyou.txt' ssh://10.10.38.122

* uses hydra (network login cracker) tool to brute-force a SSH server running on the IP address.
* \-l specifies user to be tested as "jan"
* \-P provides path to password list file which is a rockyou.txt wordlist that contains a collection of commonly used passwords.
* ssh://10.10.38.122 - SSH is the target protocol and IP to attack is 10.10.38.122



</details>

<figure><img src="../../.gitbook/assets/image (31).png" alt=""><figcaption></figcaption></figure>

And from there, I was able to retrieve the password to the user Jan, which was armando.

***

5. **What is the username?**\
   **Question Hint:** what about using SMB to find a username?

Refer to qn 4. Answer: Jan

***

6. **What is the password?**\
   **Question Hint:** What about using a tool like hydra to bruteforce?

Refer to qn 4. Answer: armando

***

7. **What service do you use to access the server(answer in abbreviation in all caps)?**\
   **Question Hint:** what command line utility is used for remote access?

To gain remote access:

```bash
ssh jan@10.10.38.122
yes
armando
```

<details>

<summary>Break down of commands</summary>

&#x20;ssh jan@10.10.38.122

* establishes an SSH connection to the IP address with the username Jan and establishes SSH session on remote system that provides access through the remote shell.

</details>

Hence, the answer is SSH.

***

8. **Enumerate the machine to find any vectors for privilege escalation**\
   **Question Hint:** use a privilege escalation checklist or tool like LinEnum

For the privilege escalation, I utilised LinPEAS, a popular tool which contains scripts for privilege escalation for Linux systems.

But before that, I wanted to take a look around in the files and directories itself.&#x20;

\[Although it didn't really work as there was not very high level of privileges granted to jan.]

{% code overflow="wrap" %}
```sh
ls -la
cat .lesshst
cat /etc/passwd
```
{% endcode %}

There wasn't much useful information here due to privilege issues, so I moved on to use LinPEAS.

{% code overflow="wrap" %}
```sh
cd/dev/shm
chmod +x linpeas.sh
./linpeas.sh | tee linpeas.txt
```
{% endcode %}





***

9. **What is the name of the other user you found(all lower case)?**\
   \


***

10. **If you have found another user, what can you do with this information?**\
    **Question Hint:** apart from a password, how else can a user access a machine?\


***

11. **What is the final password you obtain?**\
    **Question Hint:** use john the ripper to bruteforce the passphrase









